name: Delete Github Deployments

description:
  Deletes all GitHub deployments on a given branch.
  Used as workaround to delete the flood of messages visible on some PRs where environments are leveraged but deployments are not.

inputs:
  branch-name:
    description: The name of the branch for the deployments
    required: true
  environment:
    description: The optional environment for the deployments
    required: false

runs:
  using: composite
  steps:
    - uses: actions/checkout@a5ac7e51b41094c92402da3b24376905380afc29 # v4.1.6
    - name: delete-deployments
      uses: actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea # v7.0.1
      with:
        script: |
          const script = require('.github/actions/github-deployments-delete/deleteDeploymentScript.js')
          await script(
            github,
            context,
            ref:${{ inputs.branch-name }},
            environment:${{ inputs.environment }}
          );


name: 'Calculate next internal version'
description: 'Calculate next internal version based on existing tags'
inputs:
  next-version:
    description: 'Next version following the pattern MAJOR.MINOR.PATCH'
    required: true
outputs:
  next-prerelease:
    description: "Next prerelease"
    value: ${{ steps.next-prerelease-resolver.outputs.next-prerelease }}
runs:
  using: "composite"
  steps:
    - uses: actions/setup-python@v2
    - id: get-current-action-branch
      run: ${{ github.action_path }}/../shared-scripts/get-current-action-branch.sh
      shell: bash
    - uses: actions/checkout@v3
      with:
        repository: Alfresco/alfresco-build-tools
        ref: ${{steps.get-current-action-branch.outputs.action-branch}}
        path: build-tools
    - uses: ./build-tools/.github/actions/setup-pysemver
    - id: next-prerelease-resolver
      run: ${{ github.action_path }}/next-prerelease.sh
      shell: bash
      env:
        NEXT_VERSION: ${{inputs.next-version}}

name: "Package helm chart"
description: "Package helm chart by running `helm dep up` and ` helmp package`"
inputs:
  chart-dir:
    description: "Path to the folder holding Chart.yaml"
    required: true
outputs:
  package-file:
    description: The name of the generated package file
    value: ${{ steps.package.outputs.package-file }}

runs:
  using: composite
  steps:
    - name: Package
      id: package
      shell: bash
      run: |
        helm dep up ${{ inputs.chart-dir }}
        helm package ${{ inputs.chart-dir }}
        PACKAGE_FILE=$(ls | grep *\.tgz)
        echo "::set-output name=package-file::$PACKAGE_FILE"

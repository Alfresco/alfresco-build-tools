name: "Update chart version"
description: "Update the version field in the Chart.yaml file"
inputs:
  new-version:
    description: "The new version of the chart"
    required: true
  chart-dir:
    description: "The relative path to the directory holding Chart.yaml"
    required: true
  chart-repository-dir:
    description: "The path the git repository holding the chart project"
    required: false
runs:
  using: composite
  steps:
    - uses: Alfresco/alfresco-build-tools/.github/actions/setup-helm-docs@92947f8dee1180182ac6cf516edce1d4eb7d9b38 # v3.9.0
    - name: Update version
      shell: bash
      env:
        CHART_REPO_DIR: ${{inputs.chart-repository-dir }}
      run: |
        if [ -n "$CHART_REPO_DIR" ]
        then
          cd $CHART_REPO_DIR
        fi
        yq -i e '.version = "${{ inputs.new-version }}"' ${{ inputs.chart-dir }}/Chart.yaml
        helm-docs
